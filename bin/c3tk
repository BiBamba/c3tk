#!/usr/bin/env bash

cmd="${1}"

docker_run() {
  exec docker run --rm -w '/w' -v${PWD}:/w "${@}"
}

touch ~/.saferc ~/.vaultrc ~/.flyrc

# Allow this script to be symlinked as the actual command name :)
if [[ ${0//*\/} == "c3tk" ]] 
then shift
else cmd="${0//*\/}"
fi

case "${cmd}" in 
  (shell)
    docker_run \
      -it \
      -v ~/:/root \
      "starkandwayne/c3tk:latest" bash "${@}"
    ;;
  (aws)
    docker_run \
      -it \
      -v ~/.aws:/root/.aws \
      "amazon/aws-cli" aws "${@}"
    ;;
  (az)
    docker_run \
      -it \
      -v ~/.azure:/root/.azure \
      "mcr.microsoft.com/azure-cli" az "${@}"
    ;;
  (bosh)
    docker_run \
      -it \
      -v ~/.bosh:/root/.bosh \
      "starkandwayne/c3tk:latest" bosh "${@}"
    ;;
  (cf)
    docker_run \
      -it \
      -v :/root/.cf \
      "starkandwayne/c3tk:latest" cf "${@}"
    ;;
  (cc-me)
    docker_run \
      -i \
      --log-driver=none -a stdin -a stdout -a stderr \
      "starkandwayne/c3tk:latest" cc-me "${@}"
    ;;
  (sipcalc)
    docker_run \
      -i \
      --log-driver=none -a stdin -a stdout -a stderr \
      "starkandwayne/c3tk:latest" sipcalc "${@}"
    ;;
  (whois)
    docker_run \
      -i \
      --log-driver=none -a stdin -a stdout -a stderr \
      "starkandwayne/c3tk:latest" whois "${@}"
    ;;
  (netcat)
    docker_run \
      -i \
      --log-driver=none -a stdin -a stdout -a stderr \
      "starkandwayne/c3tk:latest" netcat "${@}"
    ;;
  (terraform)
    docker_run \
      -i \
      --log-driver=none -a stdin -a stdout -a stderr \
      "hashicorp/terraform:latest" terraform "${@}"
    ;;
  (tcpdump)
    docker_run \
      -i \
      --log-driver=none -a stdin -a stdout -a stderr \
      "starkandwayne/c3tk:latest" tcpdump "${@}"
    ;;
  (tig)
    docker run --rm -it \
      "starkandwayne/c3tk:latest" tig "${@}"
    ;;
  (nmap)
    docker_run \
      -i \
      --log-driver=none -a stdin -a stdout -a stderr \
      "starkandwayne/c3tk:latest" nmap "${@}"
    ;;
  (tmux)
    docker_run \
      -it \
      "starkandwayne/c3tk:latest" tmux "${@}"
    ;;
  (gpg)
    docker_run \
      -i \
      --log-driver=none -a stdin -a stdout -a stderr \
      "starkandwayne/c3tk:latest" gpg "${@}"
    ;;
  (credhub)
    docker_run \
      -it \
      -v ~/.credhub:/root/.credhub \
      "starkandwayne/c3tk:latest" credhub "${@}"
    ;;
  (genesis)
    docker_run \
      -it \
      -v ~/.ssh:/root/.ssh \
      -v ~/.saferc:/root/.saferc \
      -v ~/.vaultrc:/root/vaultrc \
      -v ~/.credhub:/root/.credhub \
      -v ~/.bosh:/root/.bosh \
      -v ~/.cf:/root/.cf \
      "starkandwayne/c3tk:latest" genesis "${@}"
    ;;
  (gcloud)
    docker_run \
      -it \
      -v ~/.gcp:/root/.gcp \
      "gcr.io/google.com/cloudsdktool/cloud-sdk:latest" gcloud "${@}"
    ;;
  (gsutil)
    docker_run \
      -it \
      -v ~/.gcp:/root/.gcp \
      "gcp-tools:latest" gsutil "${@}"
    ;;
  (jq)
    docker_run \
      -i \
      --log-driver=none -a stdin -a stdout -a stderr \
      "starkandwayne/c3tk:latest" /bin/jq "${@}"
    ;;
  (yq)
    docker_run \
      -i \
      --log-driver=none -a stdin -a stdout -a stderr \
      "starkandwayne/c3tk:latest" /bin/yq "${@}"
    ;;
  (xq)
    docker_run \
      -i \
      --log-driver=none -a stdin -a stdout -a stderr \
      "starkandwayne/c3tk:latest" xq "${@}"
    ;;
  (fly)
    docker_run \
      -it \
      -v ~/.flyrc:/root/.flyrc \
      "starkandwayne/c3tk:latest" fly "${@}"
    ;;
  (k9s)
    docker_run \
      -it \
      -v ~/.kube:/root/.kube \
      -v ~/.config:/root/config \
      "starkandwayne/c3tk:latest" k9s "${@}"
    ;;
  (kubectl)
    docker_run \
      -it \
      -v ~/.kube:/root/.kube \
      "starkandwayne/c3tk:latest" kubectl "${@}"
    ;;
  (spruce)
    docker_run \
      -i \
      --log-driver=none -a stdin -a stdout -a stderr \
      "starkandwayne/c3tk:latest" spruce "${@}"
    ;;
  (safe)
    docker_run \
      -it \
      -v ~/.saferc:/root/.saferc \
      -v ~/.vaultrc:/root/.vaultrc \
      "starkandwayne/c3tk:latest" safe "${@}"
    ;;
  (vault)
    docker_run \
      -it \
      -v ~/.vaultrc:/root/.vaultrc \
      "starkandwayne/c3tk:latest" vault "${@}"
    ;;
esac

exit 0
